@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewBag.Title - SofiaCosmetics</title>

    <!-- ========== ShopGrids CSS ========== -->
    <link rel="stylesheet" href="~/Content/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.lineicons.com/3.0/lineicons.css">
    <link rel="stylesheet" href="~/Content/tiny-slider.css" />
    <link rel="stylesheet" href="~/Content/glightbox.min.css" />
    <link rel="stylesheet" href="~/Content/Site.css" />
    <link rel="stylesheet" href="~/Content/main.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">

    @*<link rel="stylesheet" href="~/Content/test.css" />*@

    <!-- ========== Icon  ========== -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

</head>
<body>
    <!-- Preloader -->
    <div class="preloader">
        <div class="preloader-inner">
            <div class="preloader-icon">
                <span></span>
                <span></span>
            </div>
        </div>
    </div>
    <!-- /End Preloader -->
    <!-- Header -->
    @Html.Action("Header", "Home")


    @if (ViewBag.ShowSlider == true)
    {
        @Html.Action("SliderPartial", "Home")
    }



    <!-- Nội dung trang -->
    <main>
        @RenderBody()
    </main>

    <!-- Footer -->
    @Html.Partial("Footer")
    <!-- ========== JS Files ========== -->
    @*<script src="~/Scripts/bootstrap.min.js"></script>*@
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
    <script src="~/Scripts/tiny-slider.js"></script>
    <script src="~/Scripts/glightbox.min.js"></script>
    <script src="~/Scripts/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>

    <script type="text/javascript">
        //========= Hero Slider
        tns({
            container: '.hero-slider',
            slideBy: 'page',
            autoplay: true,
            autoplayButtonOutput: false,
            mouseDrag: true,
            gutter: 0,
            items: 1,
            nav: false,
            controls: true,
            controlsText: ['<i class="lni lni-chevron-left"></i>', '<i class="lni lni-chevron-right"></i>'],
        });

        //======== Brand Slider
        tns({
            container: '.brands-logo-carousel',
            autoplay: true,
            autoplayButtonOutput: false,
            mouseDrag: true,
            gutter: 15,
            nav: false,
            controls: false,
            responsive: {
                0: {
                    items: 1,
                },
                540: {
                    items: 3,
                },
                768: {
                    items: 5,
                },
                992: {
                    items: 6,
                }
            }
        });
    </script>
    <script>
        $(document).ready(function () {

            /* === SLIDER SẢN PHẨM BÁN CHẠY === */
            $(".bestseller-slider").owlCarousel({
                loop: true,
                margin: 15,
                nav: true,
                dots: false,
                autoplay: true,
                autoplayTimeout: 4000,
                autoplayHoverPause: true,
                responsive: {
                    0: { items: 1 },
                    576: { items: 2 },
                    992: { items: 3 },
                    1200: { items: 4 }
                }
            });

            /* === SLIDER LOGO THƯƠNG HIỆU === */
            $(".brand-carousel").owlCarousel({
                loop: true,
                margin: 25,
                nav: false,
                dots: false,
                autoplay: true,
                autoplayTimeout: 2000,
                autoplayHoverPause: false,
                smartSpeed: 800,
                responsive: {
                    0: { items: 3 },
                    576: { items: 4 },
                    768: { items: 5 },
                    992: { items: 6 },
                    1200: { items: 8 }
                }
            });

        });
    </script>
    <!-- Toastr CSS + JS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

    <script>
    $(document).ready(function () {
        $(".add-to-cart-btn").click(function () {
            var maCTSP = $(this).data("mactsp");

            $.ajax({
                url: '@Url.Action("ThemVaoGio", "Cart")',
                type: 'POST',
                data: { maCTSP: maCTSP },
                success: function (res) {
                    if (res.success) {
                        // ✅ Cập nhật số lượng badge trên icon
                        $(".badge-wishlist").text(res.count);

                        // ✅ Hiện thông báo đẹp
                        toastr.success("Đã thêm <b>" + res.tenSP + "</b> vào giỏ hàng 🛍️", "Thành công");

                        // ✅ Hiệu ứng rung nhẹ icon giỏ hàng
                        $(".wishlist-btn i").addClass("shake");
                        setTimeout(() => $(".wishlist-btn i").removeClass("shake"), 600);
                    } else {
                        toastr.error(res.message || "Không thể thêm sản phẩm.");
                    }
                },
                error: function () {
                    toastr.error("Có lỗi xảy ra khi thêm sản phẩm.");
                }
            });
        });
    });
    </script>
    <script>
        // Xử lý khi bấm nút Thêm vào giỏ
    $(document).on('submit', '#addToCartForm', function (e) {
        e.preventDefault(); // chặn reload trang

        var maCTSP = $('#selectedVariantId').val();

        $.ajax({
            url: '@Url.Action("ThemVaoGio", "Cart")',
            type: 'POST',
            data: { maCTSP: maCTSP },
            success: function (res) {
                if (res.success) {
                    $(".badge-wishlist").text(res.count);
                    toastr.success("Đã thêm <b>" + res.tenSP + "</b> vào giỏ hàng 🛍️", "Thành công");

                    $(".wishlist-btn i").addClass("shake");
                    setTimeout(() => $(".wishlist-btn i").removeClass("shake"), 600);
                } else {
                    toastr.error(res.message || "Không thể thêm sản phẩm.");
                }
            },
            error: function () {
                toastr.error("Có lỗi xảy ra khi thêm sản phẩm.");
            }
        });
    });
    </script>


    <style>
        @@keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }

            20%, 60% {
                transform: translateX(-4px);
            }

            40%, 80% {
                transform: translateX(4px);
            }
        }

        .shake {
            animation: shake 0.5s;
        }
    </style>
    <script>
$(document).ready(function () {
    $(".add-to-wishlist").click(function () {
        var id = $(this).data("id");
        var btn = $(this);

        $.ajax({
            url: '@Url.Action("ThemYeuThich", "Wishlist")',
            type: "GET",
            data: { id: id },
            success: function (res) {
                if (res.success) {
                    toastr.success("Đã thêm vào danh sách yêu thích 💖");
                    $(".wishlist-count").text(res.count);

                    btn.addClass("btn-pink").removeClass("btn-outline-pink");
                    btn.find("i").removeClass("lni-heart").addClass("lni-heart-filled");
                } else {
                    toastr.warning(res.message || "Sản phẩm đã có trong danh sách yêu thích!");
                }
            },
            error: function () {
                toastr.error("Lỗi kết nối đến máy chủ!");
            }
        });
    });
});

        //day la cua popup nghĩa là them gio hang dc chon chi tiet
        $(document).on("click", ".quick-view-btn", function () {
            var id = $(this).data("id");

            $.get("/Home/QuickView/" + id, function (html) {
                $("#quickViewContent").html(html);
                $("#quickViewModal").modal("show");
            });
        });

    </script>
    @*CUA THONG TIN KH*@
    <script>
        $(document).ready(function () {
            $("#userMenuToggle").click(function () {
                $("#userPopup").toggle();
            });

            $(document).click(function (e) {
                if (!$(e.target).closest('.user-login').length) {
                    $("#userPopup").hide();
                }
            });
        });

    </script>


    @RenderSection("scripts", required: false)
    <div class="modal fade" id="quickViewModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content" id="quickViewContent">
                <!-- AJAX sẽ load nội dung vào đây -->
            </div>
        </div>
    </div>

</body>
</html>
